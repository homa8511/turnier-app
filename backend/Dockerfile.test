# Argument mit Standard-Fallback definieren
ARG NODE_VERSION=22-alpine

# Verwende das gleiche Basis-Image wie in der Produktion für Konsistenz
FROM node:${NODE_VERSION}

WORKDIR /usr/src/app

# Kopiere package-Dateien und installiere ALLE Abhängigkeiten
COPY package*.json ./
RUN npm install

# Kopiere den restlichen Quellcode
COPY . .

# Kompiliere den TypeScript-Code
RUN npm run build

# Port freigeben
EXPOSE 3000

# Standard-Befehl zum Starten (wird für Tests nicht direkt verwendet)
CMD [ "npm", "start" ]